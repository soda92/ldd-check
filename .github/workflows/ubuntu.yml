name: CI - Ubuntu
on: [pull_request, push]

jobs:
  ci:
    name: Build
    runs-on: ubuntu-20.04

    steps:
      - name: "ðŸ§° Checkout"
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

      - name: "ðŸ“¥ Install dependencies"
      run: |
          sudo apt update
          sudo apt install \
            build-essential cmake ninja-build \
            fmt python
      

      - name: "ðŸš§ Build package"
        run: |
          cmake \
            -B build \
            -G "Ninja"
          cmake --build build
          mkdir build/dist
          cp build/${{env.program_name}}.exe build/dist
          python ldd-check.py -cp build/dist/${{env.program_name}}.exe

      - name: "ðŸ“¤ upload package"
        uses: actions/upload-artifact@v2
        with:
          name: build-artifacts
          path: build/dist
